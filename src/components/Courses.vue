<template>
  <div id="course" class="bg-sage-green mx-auto px-4 py-12">
    <div class="w-full md:w-1/2 mx-auto">
    <div
        v-for="(step, index) in steps"
        :key="step.title"
        class="mb-16 transition-all duration-500 ease-out"
        :style="`transition-delay: ${index * 100}ms`"
        :class="{
      'opacity-100 translate-y-0': step.isVisible,
      'opacity-0 translate-y-10': !step.isVisible
    }"
        :ref="el => { stepElements[index] = el }"
    >
      <div
          class="flex flex-col md:flex-row items-center md:items-start gap-8"
          v-intersect="[handleIntersect, { threshold: 0.1 }]"
          :class="{'!opacity-100 translate-y-0': visibleElements[index]}"
          :style="`transition-delay: ${index * 100}ms`"
      >
        <div class="w-16 h-16 rounded-full bg-logo-pink text-white flex items-center justify-center text-2xl font-bold shrink-0">
          {{ index + 1 }}
        </div>

        <div class="flex-1">
          <h3 class="text-2xl font-bold mb-4 text-dark-gray">{{ step.title }}</h3>
          <p class="text-gray-600 mb-4" v-html="step.content"></p>

          <div v-if="index === 4" class="mt-6 mx-auto text-center">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 justify-center mx-auto">
              <div class="relative w-full" style="padding-bottom: 177.78%"> <!-- 9:16 aspect ratio -->
                <iframe
                    class="absolute top-0 left-0 w-full h-full rounded-xl shadow-lg"
                    src="https://www.youtube.com/embed/32p0kdLfJV8?autoplay=0&mute=1"
                    frameborder="0"
                    allowfullscreen
                    loading="lazy"
                ></iframe>
              </div>

              <div class="relative overflow-hidden rounded-xl shadow-lg aspect-[9/16]">
                <iframe
                    class="absolute inset-0 w-full h-full"
                    src="https://www.youtube.com/embed/NV55gjHCRfg"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    loading="lazy"
                ></iframe>
              </div>

              <div class="relative overflow-hidden rounded-xl shadow-lg aspect-[9/16]">
                <iframe
                    class="absolute inset-0 w-full h-full"
                    src="https://www.youtube.com/embed/wxNTMylYazE"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    loading="lazy"
                ></iframe>
              </div>

              <div class="relative overflow-hidden rounded-xl shadow-lg aspect-[9/16]">
                <iframe
                    class="absolute inset-0 w-full h-full"
                    src="https://www.youtube.com/embed/EHXA2vppzQs"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    loading="lazy"
                ></iframe>
              </div>

              <div class="relative overflow-hidden rounded-xl shadow-lg aspect-[9/16]">
                <iframe
                    class="absolute inset-0 w-full h-full"
                    src="https://www.youtube.com/embed/C7Jyf0Zq5Gs"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    loading="lazy"
                ></iframe>
              </div>

              <div class="relative overflow-hidden rounded-xl shadow-lg aspect-[9/16]">
                <iframe
                    class="absolute inset-0 w-full h-full"
                    src="https://www.youtube.com/embed/LBUXHoijC04"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    loading="lazy"
                ></iframe>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bonus Section -->
    <div
        class="p-8 rounded-2xl bg-lavender-mist border-2 border-deep-lavender mt-12"
        v-intersect="[handleBonusIntersect, { threshold: 0.1 }]"
        :class="{'!opacity-100 translate-y-0': bonusVisible}"
    >
      <div class="flex items-center gap-4 mb-4">
        <div class="bg-logo-pink text-white p-3 rounded-full">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round"  stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-dark-gray">–ë–æ–Ω—É—Å üéÅ</h3>
      </div>
      <p class="text-gray-600">–î–ª—è –º–µ–Ω–µ –≤–∞–∂–ª–∏–≤–æ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –∑ —É—á–Ω—è–º–∏, —Ç–æ–º—É –ø—ñ—Å–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è. –í–∏ –∑–∞–≤–∂–¥–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∑–≤–æ—Ä–æ—Ç–Ω—ñ–π –∑–≤ º—è–∑–æ–∫!</p>
    </div>
    </div>
  </div>
</template>

<script setup>
import {onMounted, ref} from 'vue';
import { useIntersectionObserver } from '@vueuse/core';

const steps = ref([
  {
    title: '–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞',
    content: '–î–ª—è –ø–æ—á–∞—Ç–∫—É –º–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –≤–∏–≤—á–∞—î–º–æ –±—É–¥–æ–≤—É —à–∫—ñ—Ä–∏, —Å–ø–æ–ª—É—á–Ω–æ—ó —Ç–∫–∞–Ω–∏–Ω–∏, –∞–Ω–∞—Ç–æ–º—ñ—é –º º—è–∑—ñ–≤ –æ–±–ª–∏—á—á—è, –º–∞—Å–∞–∂–Ω—ñ –ª—ñ–Ω—ñ—ó, –≤–∏–¥–∏ –∑–º–æ—Ä—à–æ–∫ —Ç–∞ –≤—Å—é –Ω–µ–æ–±—Ö—ñ–¥–Ω—É —Ç–µ–æ—Ä—ñ—é, —è–∫–∞ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –¥–ª—è —è–∫—ñ—Å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏.'
  },
  {
    title: '–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º–æ—Ä—Ñ–æ—Ç–∏–ø—ñ–≤',
    content: '–ü—ñ—Å–ª—è —Ç–æ–≥–æ –≤—á–∏–º–æ—Å—å –¥—ñ–∞–≥–Ω–æ—Å—Ç—É–≤–∞—Ç–∏ –º–æ—Ä—Ñ–æ—Ç–∏–ø–∏ —Å—Ç–∞—Ä—ñ–Ω–Ω—è... –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ - —Ü–µ 50% —É—Å–ø—ñ—Ö—É —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.'
  },
  {
    title: '–ú–µ—Ç–æ–¥–∏—á–Ω–∞ –∫–Ω–∏–≥–∞',
    content: '–î–ª—è –∑–∞—Å–≤–æ—î–Ω–Ω—è –∑–Ω–∞–Ω—å —î –º–µ—Ç–æ–¥–∏—á–Ω–∞ –∫–Ω–∏–≥–∞, —è–∫—É –º–æ–∂–Ω–∞ —Å–∫–∞—á–∞—Ç–∏ —Å–æ–±—ñ –Ω–∞–∑–∞–≤–∂–¥–∏ —Ç–∞ –ø–µ—Ä–µ—á–∏—Ç—É–≤–∞—Ç–∏ –Ω–µ–æ–±–º–µ–∂–µ–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤.'
  },
  {
    title: '–ú–∞—Å–∞–∂–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏',
    content: '–ù–∞—Å—Ç—É–ø–Ω—ñ 6 —Ç–∏–∂–Ω—ñ–≤ –º–∏ –æ—Å–≤–æ—é—î–º–æ —Ç–µ—Ö–Ω—ñ–∫–∏ –º–∞—Å–∞–∂—É –æ–±–ª–∏—á—á—è. –í–∏–≤—á–µ–Ω–Ω—è –º–∞—Å–∞–∂–Ω–∏—Ö —Ç–µ—Ö–Ω—ñ–∫ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–æ –¥–µ—Ç–∞–ª—å–Ω–∏–º –≤—ñ–¥–µ–æ —É—Ä–æ–∫–∞–º.'
  },
  {
    title: '–í—ñ–¥–µ–æ —É—Ä–æ–∫–∏',
    videos: ['videoId1', 'videoId2', 'videoId3', 'videoId4', 'videoId5', 'videoId6']
  },
  {
    title: '–ü—Ä–∞–∫—Ç–∏–∫–∞ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞',
    content: '–ü—ñ—Å–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫—É –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞. –£—á–Ω—ñ —Ä–æ–±–ª—è—Ç—å –º–∞—Å–∞–∂ –Ω–∞ –º–æ–¥–µ–ª—è—Ö —ñ —è –ø–µ—Ä–µ–≤—ñ—Ä—è—é –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.'
  },
  {
    title: '–°–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è',
    content: '–ù–∞–≤—á–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è –∑–¥–∞—á–µ—é —ñ—Å–ø–∏—Ç—É, –ø—ñ—Å–ª—è —è–∫–æ–≥–æ –≤–∏–¥–∞—î—Ç—å—Å—è –¥–≤–∞ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏: —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é —Ç–∞ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é –º–æ–≤–∞–º–∏.'
  }
]);

const visibleElements = ref(new Array(steps.value.length).fill(false));
const bonusVisible = ref(false);

const handleIntersect = (entries, observer, index) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      visibleElements.value[index] = true;
    }
  });
};

const handleBonusIntersect = ([entry]) => {
  if (entry.isIntersecting) {
    bonusVisible.value = true;
  }
};

const stepElements = ref([]);

onMounted(() => {
  steps.value.forEach((step, index) => {
    if (stepElements.value[index]) {
      useIntersectionObserver(
          stepElements.value[index],
          ([entry]) => {
            step.isVisible = entry.isIntersecting;
          },
          { threshold: 0.1 }
      );
    }
  });
});
</script>

<style>
/* Animation styles */
[v-intersect] {
  opacity: 0;
  transform: translateY(20px);
  transition: all 0.6s ease-out;
}

[v-intresect].!opacity-100 {
  opacity: 1;
  transform: translateY(0);
}

@media (max-width: 768px) {
  .scroll-container {
    scrollbar-width: thin;
    scrollbar-color: #FF66C4 #F8F8F8;
  }

  .scroll-container::-webkit-scrollbar {
    height: 6px;
  }

  .scroll-container::-webkit-scrollbar-track {
    background: #F8F8F8;
  }

  .scroll-container::-webkit-scrollbar-thumb {
    background-color: #FF66C4;
    border-radius: 20px;
  }
}
</style>